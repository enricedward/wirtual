<html>
	<head><title>Demo</title></head>
	<body>
		<!-- Container -->
		<div class="wr-container" 
			data-brightness="medium" 
			data-skybox="assets/skybox/space" 
			data-skybox-format="png">

		</div>

		<script src="wirtual.js"></script>

		<script>

            function Button(textDescription, buttonTextures, action) {
                this.createButtonDesign = function(){
                    /*var bbox = new THREE.Box3().setFromObject(this._textMesh);
                    this._length = 1.1 * (bbox.max.x - bbox.min.x);
                    this._height = 1.1 * (bbox.max.y - bbox.min.y);*/
                    this._length = 1.1 * (2 - 0);
                    this._height = 1.1 * (1.5 - 0);
                };
                this.createTextDesign = function () {
                    if (this._text.getSize() == "lg") {
                        this._textSize = 2.5;
                    } else if (this._text.getSize() == "sm"){
                        this._textSize = 1.5;
                    } else if (this._text.getSize() == "xs"){
                        this._textSize = 1;
                    } else {
                        this._textSize = 2;
                    }
                };
                this.createButton = function(){
                    var geo = new THREE.BoxGeometry(this._length, this._height, 0.5);
                    return new THREE.Mesh(geo, this._materials.getNeutral());
                };
                this.createTextMesh = function(font) {
                    var textGeometry = new THREE.TextGeometry(this._text, {
                        font: font,
                        size: this._textSize,
                        height: this._textSize
                    });
                    return new THREE.Mesh(textGeometry, this._nameMaterial);
                };
                this.createText = function(parent){
                    var fontLoader = new THREE.FontLoader();
                    fontLoader.load('fonts/' + this._text.getFont() + '.typeface.json', function(font) {
                        parent.add(this.createTextMesh(font));
                    });
                };
                this.hover = function(){
                    var button = this._geo.children[0];
                    button.material = this._materials.getHover();
                };
                this.click = function(){
                    var button = this._geo.children[0];
                    button.material = this._materials.getClicked();
                    //var text = this._geo.children[1];
                    button.scale.z = 0.5;
                    //text.position.z += 0.3;
                };
                this.releaseClick = function(){
                    var button = this._geo.children[0];
                    button.material = this._materials.getVisited();
                    button.scale.z = 1;
                    //text.position.z -= 0.3;
                };
                this.resetNeutral = function(){
                    var button = this._geo.children[0];
                    button.material = this._materials.getNeutral();
                };
                this.getGroup = function(){
                    return this._geo;
                };
                this.getValue = function(){
                    return this._isClicked;
                };
                this.getText = function () {
                    return this._text;
                };
                this.getLink = function () {
                    return this._action;
                };
                this.setWidth = function(newWidth) {
                    this._geo.children[0].scale.x = newWidth;
                };
                this.setHeight = function(newHeight){
                    this._geo.children[0].scale.y = newHeight;
                };
                this._action = action;
                this._materials = buttonTextures;
                this._text = textDescription;
                this._geo = new THREE.Object3D();
                //this.createTextDesign();
                //this.createText(this._geo);
                //this.createButtonDesign();
                this._buttonMesh = this.createButton();
                this._geo.add(this._buttonMesh);
                this._isClicked = false;
            }

			document.addEventListener("DOMContentLoaded", function(event) {
				if (Wirtual){
                    var buttonMaterial = new THREE.MeshBasicMaterial({color: 0x2194ce});
                    var button = new Button('Test', buttonMaterial, function(){
                        console.log('clicked');
                    });
                    var scene = Wirtual.getScene();
                    if (scene){ scene.add(button._geo); }
                    else { alert("scene not initiated yet."); }
			    }
			});
		</script>

	</body>

</html>